<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GreenPay</title>

<!-- PWA setup -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00c244">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icon-192.png">

<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",sans-serif;background:#000;color:white;}
#splash{position:fixed;inset:0;background:#00c244;display:flex;align-items:center;justify-content:center;font-size:40px;font-weight:bold;z-index:10;}
#login{display:none;height:100vh;display:flex;flex-direction:column;justify-content:center;padding:30px;}
input{padding:15px;margin:10px 0;border-radius:10px;border:none;font-size:16px;}
button{padding:15px;border-radius:30px;border:none;background:#00c244;color:white;font-size:16px;margin-top:10px;}
#app{display:none;padding:20px;padding-bottom:90px;}
.balance{font-size:50px;font-weight:bold;margin:20px 0;}
.card{background:#111;padding:20px;border-radius:20px;margin-top:20px;}
.tx{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid #222;cursor:pointer;}
.nav{position:fixed;bottom:0;left:0;right:0;background:#000;display:flex;justify-content:space-around;padding:15px 0;border-top:1px solid #222;}
</style>
</head>

<body>

<div id="splash">GreenPay</div>

<!-- Login Screen -->
<div id="login">
<h2>Login</h2>
<input id="username" placeholder="Username">
<input type="password" placeholder="Password">
<button onclick="login()">Login</button>
</div>

<!-- App Screen -->
<div id="app">
<h2>Money</h2>
<div class="balance" id="balance">$500.00</div>

<div class="card">
<h3>Add Money</h3>
<input id="addAmount" placeholder="Amount">
<button onclick="addMoney()">Add</button>
</div>

<div class="card">
<h3>Send Money</h3>
<input id="sendUser" placeholder="Recipient">
<input id="sendAmount" placeholder="Amount">
<button onclick="sendMoney()">Send</button>
</div>

<div class="card">
<h3>Recent Activity</h3>
<div id="history"></div>
</div>
</div>

<div class="nav">
<div>üè†</div>
<div>$</div>
<div>üïí</div>
</div>

<script>
// Persistent balance & history
let balance = Number(localStorage.getItem("balance")) || 500;
let historyData = JSON.parse(localStorage.getItem("history")) || [];

// Splash screen
setTimeout(()=>{
document.getElementById("splash").style.display="none";
if(localStorage.getItem("loggedIn")){
showApp();
}else{
document.getElementById("login").style.display="flex";
}
},1500);

// Login
function login(){
localStorage.setItem("loggedIn",true);
showApp();
}

// Show app
function showApp(){
document.getElementById("login").style.display="none";
document.getElementById("app").style.display="block";
updateUI();
}

// Update UI
function updateUI(){
document.getElementById("balance").innerText="$"+balance.toFixed(2);
let historyDiv=document.getElementById("history");
historyDiv.innerHTML="";
historyData.forEach((tx,index)=>{
historyDiv.innerHTML+=`
<div class="tx" onclick="openTx(${index})">
<div>${tx.name}</div>
<div>${tx.amount}</div>
</div>
`;
});
}

// Add / Send
function addMoney(){
let amt=Number(document.getElementById("addAmount").value);
if(!amt) return;
balance+=amt;
historyData.unshift({name:"Deposit",amount:"+$"+amt});
save();
}

function sendMoney(){
let user=document.getElementById("sendUser").value;
let amt=Number(document.getElementById("sendAmount").value);
if(!user||!amt) return;
balance-=amt;
historyData.unshift({name:user,amount:"-$"+amt});
save();
}

// Save
function save(){
localStorage.setItem("balance",balance);
localStorage.setItem("history",JSON.stringify(historyData));
updateUI();
}

// Open transaction detail
function openTx(index){
localStorage.setItem("txIndex",index);
window.location.href="transaction.html";
}

// Register service worker
if("serviceWorker" in navigator){
navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
